<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Apache Pulsar Schema versus Schemaless — Who’s the Winner? - Pulsar Neighborhood</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The Pulsar Neighborhood community enables Apache Pulsar users and developers to learn about Pulsar and how to use it in their professional lives; via useful, interactive content (including blogs, Meetups, and YouTube videos). This is all driven by a passionate, vendor neutral, and inclusive community of members."><meta property="og:title" content="The Pulsar Neighborhood"><meta property="og:type" content="article"><meta property="og:url" content="https://www.pulsar-neighborhood.io"><meta property="og:image" content="https://www.pulsar-neighborhood.io/png/blue-logotype.png"><meta property="og:description" content="The Pulsar Neighborhood community enables Apache Pulsar users and developers to learn about Pulsar and how to use it in their professional lives; via useful, interactive content (including blogs, Meetups, and YouTube videos). This is all driven by a passionate, vendor neutral, and inclusive community of members."><meta name=twitter:site content="@pulsar_neighbor"><meta name=twitter:creator content="@pulsar_neighbor"><link rel=alternate type=application/rss+xml href=/index.xml title="Site Title"><meta name=google-site-verification content="m-1Z-0k0EvG9PD7R24pKuETSaBpEvqoXgOYT-0MtuPU"><link rel=icon href=https://www.pulsar-neighborhood.io/favicon.png><link rel=stylesheet href=/css/style.02a3c9564297b7f12955dc1913e79bea4027f3223736d6e40d3eeab5640e9abe.css><style>.ctct-form-defaults{padding:15px!important}</style></head><body class='page bg-secondary'><div id=main-menu-mobile class=main-menu-mobile><ul></ul></div><div class=wrapper><div class='header sticky-top bg-secondary'><div class=container><div class=logo><a href=https://www.pulsar-neighborhood.io><img src=/svg/Pulsar-Neighborhood-Logo.svg class=img-fluid></a></div><div class=logo-mobile><a href=https://www.pulsar-neighborhood.io><img src=/svg/Neighborhood-Icon.svg class=img-fluid></a></div><h4 class="badge1 badge-pill badge-info p-1" data-toggle=modal data-target=#sticker-signup style=cursor:pointer>&nbsp;&nbsp;Free Pulsar Stickers!&nbsp;&nbsp;</h4><div id=main-menu class=main-menu><ul><li><a href=/about><span>About The Pulsar Neighborhood</span></a></li><li><a href=https://pulsar.apache.org/ target=_blank><span>About Apache Pulsar</span></a></li><li><a href=https://pulsar.apache.org/docs/en/standalone/ target=_blank><span></span>Project Documentation</span></a></li><li><a href=/index.xml><img src=/svg/square-rss-solid.svg title="Subscribe to The Pulsar Neighborhood feed" class=img-fluid style=height:30px></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pb-3"><div class=row><div class="col-0 col-md-2"><div class=sidebar><div class=mb-2><a href=/guides/getting-started><div class="col-12 btn btn-success">Get Started with Pulsar</div></a></div><div class="spotlight mb-2 border border-primary rounded"><div class="row bg-primary no-gutters"><div class="col-12 text-secondary p-1">&nbsp;Find Articles and Guides</div></div><div class=p-1><div class="row no-gutters"><div class="col-12 mb-1"><h4>Level</h4><ul><li><input class=form-check-input type=checkbox id=100 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=100>&nbsp;Beginner (100)</label></li><li><input class=form-check-input type=checkbox id=200 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=200>&nbsp;Intermediate (200)</label></li><li><input class=form-check-input type=checkbox id=300 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=300>&nbsp;Advanced (300)</label></li></ul></div><div class="row no-gutters"><div class=col-12><h4>Category</h4><ul><li><input class=form-check-input type=checkbox id=at-the-edge onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=at-the-edge>&nbsp;At the Edge [2]</label></li><li><input class=form-check-input type=checkbox id=cluster-administration onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=cluster-administration>&nbsp;Cluster Administration [2]</label></li><li><input class=form-check-input type=checkbox id=getting-started onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=getting-started>&nbsp;Getting Started [11]</label></li><li><input class=form-check-input type=checkbox id=machine-learning onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=machine-learning>&nbsp;Machine Learning [2]</label></li><li><input class=form-check-input type=checkbox id=moving-to-pulsar onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=moving-to-pulsar>&nbsp;Moving to Pulsar [4]</label></li><li><input class=form-check-input type=checkbox id=newsletter onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=newsletter>&nbsp;Newsletter [7]</label></li><li><input class=form-check-input type=checkbox id=project-news onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=project-news>&nbsp;Project News [3]</label></li><li><input class=form-check-input type=checkbox id=pulsar-architecture onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=pulsar-architecture>&nbsp;Pulsar Architecture [9]</label></li><li><input class=form-check-input type=checkbox id=pulsar-components onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=pulsar-components>&nbsp;Pulsar Components [5]</label></li><li><input class=form-check-input type=checkbox id=use-cases onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=use-cases>&nbsp;Use Cases [3]</label></li></ul></div></div></div></div></div></div></div><div class="col-12 col-md-8"><div class=container><header class=mb-3><div class=pb-2><img src=https://user-images.githubusercontent.com/16946028/163627115-5ecb2834-3c8c-42ee-8ab1-1bb52f110f05.png alt class=img-fluid style=max-width:85%;max-height:200px></div><h1>Apache Pulsar Schema versus Schemaless — Who’s the Winner?</h1></header><div class="row mb-3 no-gutters border-top border-bottom"><div class=col-2><ul class="list-group list-group-horizontal mt-1 mb-1"><li class="list-group-item flex-fill border-0 p-0 mr-3"><a href="https://www.linkedin.com/sharing/share-offsite/?mini=true&url=https%3a%2f%2fwww.pulsar-neighborhood.io%2farticles%2fapache-pulsar-schema-versus-schemaless-whos-the-winner%2f&title=Apache%20Pulsar%20Schema%20versus%20Schemaless%20%e2%80%94%20Who%e2%80%99s%20the%20Winner%3f" target=_blank><img src=/svg/linkedin-in-brands.svg title="Share this on LinkedIn" class=img-fluid></a></li><li class="list-group-item flex-fill border-0 p-0 mr-3"><a target=_blank href="https://twitter.com/intent/tweet?text=Apache%20Pulsar%20Schema%20versus%20Schemaless%20%e2%80%94%20Who%e2%80%99s%20the%20Winner%3f&url=https%3a%2f%2fwww.pulsar-neighborhood.io%2farticles%2fapache-pulsar-schema-versus-schemaless-whos-the-winner%2f&hashtags=apachepulsar&via=pulsar_neighbor"><img src=/svg/twitter-brands.svg title="Share this on Twitter" class=img-fluid></a></li></ul></div><div class="col text-right"><span class=text-muted>Author:</span> Pulsar Neighborhood<br><span class=text-muted>Published:</span> April 15, 2022</div></div><article><p>Apache Pulsar is a cloud-native, open-source distributed streaming and messaging platform. Yahoo designed the system to fulfill the need for durability and scalability. One of its unique and critical components is the <a href=https://pulsar.apache.org/docs/en/schema-get-started/ target=_blank>Apache Pulsar Schema</a>.</p><p>A schema defines a data structure that a message should follow to be understood and processed across a network. Essentially, it provides a blueprint of how the message should look.</p><p>Initially, data streaming did not use a schema; raw bytes were efficient and neutral vehicles. However, developers had to overlay their serialization mechanisms to ensure that processes on the receiving end were able to read and interpret the bytes fed into the system. This situation required creating an extra layer to monitor bytes flowing through the system.</p><p>Another challenge that raw bytes presented was the pipeline’s inability to cope with changes in data structures. If a developer slightly changes a field, the entire system starts throwing errors because the end systems’ binaries store all information related to structures.</p><p>Pulsar Schema solved all of these problems by introducing a new sender-receiver coordination mechanism. It has since become a system of choice for many developers. Verizon, Tencent, Comcast, Overstock.com, and numerous other enterprises have adopted this method.</p><p>In this article, we’ll examine how Pulsar Schemas work and contrast them with schemaless systems to determine the best approach. We’ll also demonstrate how to use Java clients with Pulsar.</p><h2 id=how-schemas-work>How Schemas Work</h2><p>Pulsar Schemas have two endpoints: a producer side that sends data and a consumer side that receives data. The two connect through brokers that communicate with the back-end processes.</p><p>Although the producer and consumer don’t connect directly, a contract specifies that the data a producer writes should follow a schema that a consumer can read. A schema registry enforces this contract by verifying the compatibility of schemas that each forwards to the brokers. It applies and enforces Pulsar Schemas at the topic level.</p><p>A topic is just an abstraction in the form of a Uniform Resource Identifier (URI). It groups messages based on context. A topic structure looks like this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-0-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-0-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>{</span>type<span style=color:#f92672>}</span>://<span style=color:#f92672>{</span>tenant<span style=color:#f92672>}</span>/<span style=color:#f92672>{</span>namespace<span style=color:#f92672>}</span>/<span style=color:#f92672>{</span>topic<span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=how-a-schema-works-on-the-producer-side>How a Schema Works on the Producer Side</h3><p>Before a producer sends data, it forwards the <code>schema info</code> to a broker. The broker checks the schema storage to verify that the received schema has been registered.</p><p>The broker sends the schema version back to the producer if it is registered. If it is not registered, the broker checks whether it can automatically generate the schema in that namespace. If possible, the broker creates a schema, registers it, and returns the schema version to the producer. If it is not possible, it rejects the connection to the broker.</p><p>Below is a producer-side schema verification chart:</p><p><img src=https://user-images.githubusercontent.com/16946028/161617001-c4a7d455-e7f6-41fb-a0ff-08aed39ec50d.png alt=producer-side-schema-verification></p><h3 id=how-a-schema-works-on-the-consumer-side>How a Schema Works on the Consumer Side</h3><p>First, the application uses a schema instance to create a consumer instance that has the <code>schema info</code>. The consumer then forwards the schema information to the broker.</p><p>The broker checks if the topic has any of the following:</p><ul><li>A schema</li><li>Data</li><li>A local consumer</li><li>A local producer</li></ul><p>If it doesn’t contain them all and <code>isAllowAutoUpdateSchema</code> is set to <code>true</code>, the broker registers the schema and the consumer connects to the broker. If <code>isAllowAutoUpdateSchema</code> is <code>false</code>, the broker rejects the connection.</p><p>If the schema only has one of the listed components, the broker performs a schema compatibility check. If it is compatible, the consumer is allowed to connect to the broker. The broker rejects the connection if it doesn’t pass the compatibility check.</p><p><img src=https://user-images.githubusercontent.com/16946028/161617110-d7e7b53c-5d6e-40bb-beb4-d68743eb2f87.png alt=consumer-side-schema-verification></p><h2 id=when-to-use-schemaless>When to Use Schemaless</h2><p>A Pulsar instance natively supports multiple clusters. It can seamlessly geo-replicate messages across clusters and scale out to more than a million topics with low latency.</p><p>Nonetheless, schemas are not a one-size-fits-all solution. In some cases, schemaless is more efficient and sustainable.</p><p>Consider a situation wherein we want to manage documents instead of uniform data structures. If we have documents in JSON with fields that are not uniform, we want a flexible solution that can adjust accordingly.</p><h2 id=using-java-clients-with-pulsar>Using Java Clients with Pulsar</h2><p>We have explored how a consumer and producer communicate with a schema registry. Now, we’ll create a Java application that uses Apache Pulsar.</p><p>We’ll start by creating a Maven project that contains an Apache Pulsar client as a dependency:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-6>6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-1-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-1-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-xml data-lang=xml><span style=display:flex><span> <span style=color:#f92672>&lt;dependencies&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;dependency&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>&lt;groupId&gt;</span> org.apache.pulsar<span style=color:#f92672>&lt;/groupId&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>&lt;artifactId&gt;</span>pulsar-client<span style=color:#f92672>&lt;/artifactId&gt;</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>&lt;version&gt;</span>2.4.1<span style=color:#f92672>&lt;/version&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;/dependency&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/dependencies&gt;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=adding-a-producer>Adding a Producer</h3><p>Before we can create a producer, we must initiate the Pulsar client using this code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-2-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-2-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>PulsarClient pulsarClient <span style=color:#f92672>=</span> PulsarClient<span style=color:#f92672>.</span><span style=color:#a6e22e>builder</span><span style=color:#f92672>()</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>serviceUrl</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;pulsar://localhost:8080&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>build</span><span style=color:#f92672>();</span>
</span></span></code></pre></td></tr></table></div></div><p>We can now create a producer client that is attached to a topic. We’ll use the Pulsar client we created above to initiate the new producer client:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-3-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-3-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>Producer<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> producer <span style=color:#f92672>=</span> pulsarClient<span style=color:#f92672>.</span><span style=color:#a6e22e>newProducer</span><span style=color:#f92672>(</span>Schema<span style=color:#f92672>.</span><span style=color:#a6e22e>STRING</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>topic</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;fun-topic&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>create</span><span style=color:#f92672>();</span>
</span></span></code></pre></td></tr></table></div></div><p>At this point, the broker will block the <code>send()</code> method until the schema registry verifies the schema. After the broker sends an acknowledgment, we can call the <code>send()</code> function like this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>producer<span style=color:#f92672>.</span><span style=color:#a6e22e>send</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Hello there!&#34;</span><span style=color:#f92672>);</span>
</span></span></code></pre></td></tr></table></div></div><p>After that, we close the producer using this code:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>producer<span style=color:#f92672>.</span><span style=color:#a6e22e>close</span><span style=color:#f92672>();</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=adding-a-consumer>Adding a Consumer</h3><p>We’ll use the Pulsar client to create a new consumer. In this example, we’ll create an exclusive consumer specified by <code>subscriptionType()</code>:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-6-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-6-5>5</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span>Consumer<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> consumer <span style=color:#f92672>=</span> pulsarClient<span style=color:#f92672>.</span><span style=color:#a6e22e>newConsumer</span><span style=color:#f92672>(</span>Schema<span style=color:#f92672>.</span><span style=color:#a6e22e>STRING</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>topic</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;fun-topic&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>subscriptionName</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;fun-subscription&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>subscriptionType</span><span style=color:#f92672>(</span>SubscriptionType<span style=color:#f92672>.</span><span style=color:#a6e22e>Exclusive</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>       <span style=color:#f92672>.</span><span style=color:#a6e22e>subscribe</span><span style=color:#f92672>();</span>
</span></span></code></pre></td></tr></table></div></div><p>Next, we’ll call the method <code>receiver()</code> in a while loop to fetch any produced messages in the subscribed topic:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-6>6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-7>7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-8>8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-7-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-7-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>while</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>true</span><span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>   Message<span style=color:#f92672>&lt;</span>String<span style=color:#f92672>&gt;</span> myMessage <span style=color:#f92672>=</span> consumer<span style=color:#f92672>.</span><span style=color:#a6e22e>receive</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>       System<span style=color:#f92672>.</span><span style=color:#a6e22e>out</span><span style=color:#f92672>.</span><span style=color:#a6e22e>printf</span><span style=color:#f92672>(</span><span style=color:#e6db74>&#34;Here is the message: %s&#34;</span><span style=color:#f92672>,</span> myMessage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>       consumer<span style=color:#f92672>.</span><span style=color:#a6e22e>acknowledge</span><span style=color:#f92672>(</span>myMessage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>Exception e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>       consumer<span style=color:#f92672>.</span><span style=color:#a6e22e>negativeAcknowledge</span><span style=color:#f92672>(</span>myMessage<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></td></tr></table></div></div><p>In the code above, the consumer instance alerts the broker when it receives the message by invoking <code>acknowledge()</code>. It also sends an alert if it fails by invoking <code>negativeAcknowledge()</code>.</p><p>That is all that’s required. We now have a simple Java application that communicates to Pulsar using a Pulsar client.</p><h2 id=pulsar-schemas-pros-and-cons>Pulsar Schema’s Pros and Cons</h2><p><strong>Schema Pros:</strong></p><ul><li>Pulsar stamps every piece of data passing through its system with a name and schema version. This makes all data passing through the system easily discoverable.</li><li>Schema provides an easy way for producers and consumers to coordinate their data structure. If the producer’s schema changes, the registry ensures it is compatible with the old consumer schemas. This approach enables us to create systems that can adapt to data structure changes without the message pipeline failing.</li></ul><p><strong>Schema Cons:</strong></p><ul><li>Schemas are relatively restrictive. We must know the data structure beforehand.</li></ul><h2 id=schemaless-pros-and-cons>Schemaless Pros and Cons</h2><p><strong>Schemaless Pros:</strong></p><ul><li>Schemaless approaches are efficient and neutral to the data they transmit.</li><li>They enable us to create a streaming pipeline even when the data structure is unclear.</li></ul><p><strong>Schemaless Cons:</strong></p><ul><li>Data structures are stored locally on both ends, making it challenging to synchronize them with one another.</li><li>Schemaless requires significant work to change the data structure.</li></ul><h2 id=conclusion>Conclusion</h2><p>Pulsar Schema’s distributed data streaming platform provides an easy and efficient way of coordinating data producers and consumers. It can adapt to schema changes without shutting down the streaming pipeline.</p><p>Although it requires some effort to set up, Pulsar Schema provides a consistent system once complete. There are some use cases where schemaless is a more appropriate solution. In all other instances, Pulsar Schema offers a resilient, scalable data-streaming method that works across multiple clusters.</p></article><div class="row border border-primary rounded"><div class="col p-2"><h3>You might also like...</h3><div class=row><div class="col text-center p-2"><div><a href=/articles/understanding-the-differences-between-message-queues-and-streaming/><img src=https://user-images.githubusercontent.com/16946028/159678986-ccaf6b62-e9ea-43c5-8901-3361f5392bfb.png alt class=img-fluid style=max-width:150px></a></div><div class=pt-2><a href=/articles/understanding-the-differences-between-message-queues-and-streaming/>Understanding the Differences Between Message Queues and Streaming</a></div><div class=pt-2>Almost any application that requires real-time or near-real-time data processing benefits from …</div></div><div class="col text-center p-2"><div class=pt-2><a href=/articles/pulsar-queuing-and-streaming-an-all-in-one-messaging-system/>Pulsar: Queuing and Streaming - An All in One Messaging System</a></div><div class=pt-2>I would also like to focus this reading on what is Pulsar and how it works under its own merits …</div></div><div class="col text-center p-2"><div class=pt-2><a href=/articles/building-a-high-available-messaging-system-a-step-by-step-cookbook/>Pulsar: Building a High Available Messaging System - A Step by Step CookBook</a></div><div class=pt-2>This guide will walk you step by step to deploy a Pulsar instance with one cluster but prepared …</div></div></div></div></div><br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="pulsar-neighborhood",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><div class="col-0 col-md-2"><nav class="navbar navbar-light mb-3"><div class=row><div class=col-12><h4>In this article</h4></div><div class="col-12 border-left border-primary pr-0"><nav id=TableOfContents><ul><li><a href=#how-schemas-work>How Schemas Work</a><ul><li><a href=#how-a-schema-works-on-the-producer-side>How a Schema Works on the Producer Side</a></li><li><a href=#how-a-schema-works-on-the-consumer-side>How a Schema Works on the Consumer Side</a></li></ul></li><li><a href=#when-to-use-schemaless>When to Use Schemaless</a></li><li><a href=#using-java-clients-with-pulsar>Using Java Clients with Pulsar</a><ul><li><a href=#adding-a-producer>Adding a Producer</a></li><li><a href=#adding-a-consumer>Adding a Consumer</a></li></ul></li><li><a href=#pulsar-schemas-pros-and-cons>Pulsar Schema’s Pros and Cons</a></li><li><a href=#schemaless-pros-and-cons>Schemaless Pros and Cons</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></nav><div class="row border border-primary rounded no-gutters"><div class="col-12 bg-primary p-1"><div class=text-secondary>&nbsp;Join Our Newsletter</div></div><div class=col-12><div class=ctct-inline-form data-form-id=7514f5a0-b12d-44b3-93bf-e16449e783ca style=padding:0></div></div></div></div></div></div></div><div class="sub-footer m-5"><div class=row><div class="col-12 text-center"><a href=https://github.com/pulsar-neighborhood/pulsar-neighborhood.github.io/blob/main/content/articles/Apache-Pulsar-Schema-versus-Schemaless-Whos-the-Winner.md target=_blank>Improve this page</a></div></div><div class="col-8 offset-2"><hr class="bg-primary text-primary"></div><div class="sub-footer-inner mt-2"><div><div class=mb-1>Pulsar Neighborhood</div><div><ul><li style=width:40px><a href=https://github.com/pulsar-neighborhood target=_blank><img src=/svg/github-brands.svg title="Pulsar Neighborhood on GitHub" class=img-fluid></a></li><li class="ml-3 mr-1" style=width:40px><a href=https://twitter.com/pulsar_neighbor target=_blank><img src=/svg/twitter-brands.svg title="Pulsar Neighborhood on Twitter" class=img-fluid></a></li><li style=width:40px><a href=https://www.youtube.com/c/ApachePulsarNeighborhood target=_blank><img src=/svg/youtube-brands.svg title="Pulsar Neighborhood on YouTube" class=img-fluid></a></li><li style=width:40px><a href=https://datastudio.google.com/reporting/743d9f31-c80f-4e60-b520-730631d3c250 target=_blank><img src=/png/google-analytics.png title="Pulsar Neighborhood analytics" class=img-fluid></a></li></ul></div></div><div class=p-5></div><div><div class=mb-1>Apache Pulsar</div><div><ul><li style=width:40px><a href=https://pulsar.apache.org target=_blank><img src=/png/pulsar-icon.jpg title="Apache Pulsar project home" class=img-fluid></a></li><li class="ml-3 mr-1" style=width:40px><a href=https://github.com/apache-pulsar target=_blank><img src=/svg/github-brands.svg title="Apache Pulsar on GitHub" class=img-fluid></a></li><li class=mr-1 style=width:40px><a href=https://twitter.com/Apache_Pulsar target=_blank><img src=/svg/twitter-brands.svg title="Apache Pulsar on Twitter" class=img-fluid></a></li><li class=mr-1 style=width:30px><a href=https://stackoverflow.com/questions/tagged/apache-pulsar target=_blank><img src=/svg/stack-overflow-brands.svg title="Apache Pulsar on Stackoverflow" class=img-fluid></a></li><li style=width:40px><a href=https://apache-pulsar.slack.com target=_blank><img src=/svg/slack-brands.svg title="Apache Pulsar slack channel" class=img-fluid></a></li></ul></div></div></div><div class="row text-center mb-3"><div class=col-12><a class="btn btn-info" href=https://pulsar.apache.org/community/ target=_blank>Join the Pulsar community</a></div></div><div class="row text-center"><div class="col-12 text-center"><div>Privacy Policy&nbsp;&nbsp;|&nbsp;&nbsp;Terms & Condition</div></div></div></div><script type=text/javascript src=/js/scripts.min.8efe3e711319c2d0a300a084134e3f3bedcb60dce21f1e0ef12767f654242b44.js></script>
<script type=text/javascript src=/js/filter.min.2ee09abe7fb6b636d1e7cc4506185cec9d630337089eff4daf0ccc27318f376e.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js integrity=sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF crossorigin=anonymous></script>
<script>var _ctct_m="310a7590faa964361197c4644ef1de96"</script><script id=signupScript src=//static.ctctcdn.com/js/signup-form-widget/current/signup-form-widget.min.js async defer></script><div class="modal fade" id=sticker-signup tabindex=-1 role=dialog aria-labelledby=sticker-signup aria-hidden=true><div class="modal-dialog modal-dialog-centered modal-lg" role=document><div class=modal-content><iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeUE7DY5caXwkOj2Rsn30hsJVCn8zdWhDBQwlPYvP9lrztqwQ/viewform?embedded=true" width=100% height=700 frameborder=0 marginheight=0 marginwidth=0>Loading…</iframe></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-8S9SD43SBH"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8S9SD43SBH")</script></body></html>
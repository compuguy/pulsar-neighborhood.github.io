<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><title>Pulsar: Building a High Available Messaging System - A Step by Step CookBook - Pulsar Neighborhood</title><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="The Pulsar Neighborhood community enables Apache Pulsar users and developers to learn about Pulsar and how to use it in their professional lives; via useful, interactive content (including blogs, Meetups, and YouTube videos). This is all driven by a passionate, vendor neutral, and inclusive community of members."><meta property="og:title" content="The Pulsar Neighborhood"><meta property="og:type" content="article"><meta property="og:url" content="https://www.pulsar-neighborhood.io"><meta property="og:image" content="https://www.pulsar-neighborhood.io/png/blue-logotype.png"><meta property="og:description" content="The Pulsar Neighborhood community enables Apache Pulsar users and developers to learn about Pulsar and how to use it in their professional lives; via useful, interactive content (including blogs, Meetups, and YouTube videos). This is all driven by a passionate, vendor neutral, and inclusive community of members."><meta name=twitter:site content="@pulsar_neighbor"><meta name=twitter:creator content="@pulsar_neighbor"><link rel=alternate type=application/rss+xml href=/index.xml title="Site Title"><meta name=google-site-verification content="m-1Z-0k0EvG9PD7R24pKuETSaBpEvqoXgOYT-0MtuPU"><link rel=icon href=https://www.pulsar-neighborhood.io/favicon.png><link rel=stylesheet href=/css/style.02a3c9564297b7f12955dc1913e79bea4027f3223736d6e40d3eeab5640e9abe.css><style>.ctct-form-defaults{padding:15px!important}</style></head><body class='page bg-secondary'><div id=main-menu-mobile class=main-menu-mobile><ul></ul></div><div class=wrapper><div class='header sticky-top bg-secondary'><div class=container><div class=logo><a href=https://www.pulsar-neighborhood.io><img src=/svg/Pulsar-Neighborhood-Logo.svg class=img-fluid></a></div><div class=logo-mobile><a href=https://www.pulsar-neighborhood.io><img src=/svg/Neighborhood-Icon.svg class=img-fluid></a></div><h4 class="badge1 badge-pill badge-info p-1" data-toggle=modal data-target=#sticker-signup style=cursor:pointer>&nbsp;&nbsp;Free Pulsar Stickers!&nbsp;&nbsp;</h4><div id=main-menu class=main-menu><ul><li><a href=/about><span>About The Pulsar Neighborhood</span></a></li><li><a href=https://pulsar.apache.org/ target=_blank><span>About Apache Pulsar</span></a></li><li><a href=https://pulsar.apache.org/docs/en/standalone/ target=_blank><span></span>Project Documentation</span></a></li><li><a href=/index.xml><img src=/svg/square-rss-solid.svg title="Subscribe to The Pulsar Neighborhood feed" class=img-fluid style=height:30px></a></li></ul></div><button id=toggle-main-menu-mobile class="hamburger hamburger--slider" type=button>
<span class=hamburger-box><span class=hamburger-inner></span></span></button></div></div><div class="container pt-2 pb-3"><div class=row><div class="col-0 col-md-2"><div class=sidebar><div class=mb-2><a href=/guides/getting-started><div class="col-12 btn btn-success">Get Started with Pulsar</div></a></div><div class="spotlight mb-2 border border-primary rounded"><div class="row bg-primary no-gutters"><div class="col-12 text-secondary p-1">&nbsp;Find Articles and Guides</div></div><div class=p-1><div class="row no-gutters"><div class="col-12 mb-1"><h4>Level</h4><ul><li><input class=form-check-input type=checkbox id=100 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=100>&nbsp;Beginner (100)</label></li><li><input class=form-check-input type=checkbox id=200 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=200>&nbsp;Intermediate (200)</label></li><li><input class=form-check-input type=checkbox id=300 onclick=toggleFilter(filterOptions.levelFilters,this.id)><label class=form-check-label for=300>&nbsp;Advanced (300)</label></li></ul></div><div class="row no-gutters"><div class=col-12><h4>Category</h4><ul><li><input class=form-check-input type=checkbox id=at-the-edge onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=at-the-edge>&nbsp;At the Edge [2]</label></li><li><input class=form-check-input type=checkbox id=cluster-administration onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=cluster-administration>&nbsp;Cluster Administration [2]</label></li><li><input class=form-check-input type=checkbox id=getting-started onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=getting-started>&nbsp;Getting Started [13]</label></li><li><input class=form-check-input type=checkbox id=machine-learning onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=machine-learning>&nbsp;Machine Learning [2]</label></li><li><input class=form-check-input type=checkbox id=moving-to-pulsar onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=moving-to-pulsar>&nbsp;Moving to Pulsar [6]</label></li><li><input class=form-check-input type=checkbox id=newsletter onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=newsletter>&nbsp;Newsletter [7]</label></li><li><input class=form-check-input type=checkbox id=project-news onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=project-news>&nbsp;Project News [3]</label></li><li><input class=form-check-input type=checkbox id=pulsar-architecture onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=pulsar-architecture>&nbsp;Pulsar Architecture [9]</label></li><li><input class=form-check-input type=checkbox id=pulsar-components onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=pulsar-components>&nbsp;Pulsar Components [5]</label></li><li><input class=form-check-input type=checkbox id=use-cases onclick=toggleFilter(filterOptions.categoryFilters,this.id)>
<label class=form-check-label for=use-cases>&nbsp;Use Cases [4]</label></li></ul></div></div></div></div></div></div></div><div class="col-12 col-md-8"><div class=container><header class=mb-3><div class=pb-2></div><h1>Pulsar: Building a High Available Messaging System - A Step by Step CookBook</h1></header><div class="row mb-3 no-gutters border-top border-bottom"><div class=col-2><ul class="list-group list-group-horizontal mt-1 mb-1"><li class="list-group-item flex-fill border-0 p-0 mr-3"><a href="https://www.linkedin.com/sharing/share-offsite/?mini=true&url=https%3a%2f%2fwww.pulsar-neighborhood.io%2farticles%2fbuilding-a-high-available-messaging-system-a-step-by-step-cookbook%2f&title=Pulsar%3a%20Building%20a%20High%20Available%20Messaging%20System%20-%20A%20Step%20by%20Step%20CookBook" target=_blank><img src=/svg/linkedin-in-brands.svg title="Share this on LinkedIn" class=img-fluid></a></li><li class="list-group-item flex-fill border-0 p-0 mr-3"><a target=_blank href="https://twitter.com/intent/tweet?text=Pulsar%3a%20Building%20a%20High%20Available%20Messaging%20System%20-%20A%20Step%20by%20Step%20CookBook&url=https%3a%2f%2fwww.pulsar-neighborhood.io%2farticles%2fbuilding-a-high-available-messaging-system-a-step-by-step-cookbook%2f&hashtags=apachepulsar&via=pulsar_neighbor"><img src=/svg/twitter-brands.svg title="Share this on Twitter" class=img-fluid></a></li></ul></div><div class="col text-right"><span class=text-muted>Author:</span> Ivan Garcia<br><span class=text-muted>Published:</span> March 22, 2022</div></div><article><h3 id=a-step-by-step-cookbook>A step by step cookbook</h3><hr><h4 id=-ivan-garcia---feb-2022---20-min-read>‚úèÔ∏è Ivan Garcia / üìÜ Feb 2022 / üïë 20 min read</h4><h4 id=httpsgithubcomivangdrpulsar-building-a-high-available-messaging-system><a href=https://github.com/IvanGDR/Pulsar-Building-A-High-Available-Messaging-System target=_blank>https://github.com/IvanGDR/Pulsar-Building-A-High-Available-Messaging-System</a></h4><hr><blockquote><p>This second part of this blog series over apache Pulsar, is all about building the stack. The intention is to provide a cookbook guide for you to do it.
It is important to highlight that I am trying to provide a deployment that can offer high availability properties hence the use of a zookeeper ensemble. According to documentation, it may be acceptable to use just one Zookeeper node as the workload pushed from Pulsar and BookKeeper is not expected to be a real constraint but a single point of failure is expected to be assumed in this way.</p></blockquote><h2 id=context>Context</h2><p>From an architectural point of view, the aim is to build a Pulsar instance with multi cluster properties and functions worker enabled within brokers.</p><p>This guide will walk you step by step to deploy a Pulsar instance with one cluster but prepared already to extend the deployment further, including more Pulsar clusters at a later stage.
Additionally all the stack will be built up separately, Zookeeper, BookKeeper and Pulsar all will be deployed and installed on their own cluster/ensemble and configured accordingly so they can interact with each other.</p><p>The procedure followed here is for a multi cluster baremetal deployment.</p><h2 id=resources>Resources</h2><p>The open source software to be used are the following binaries:</p><pre><code>- apache-pulsar-2.8.1-bin.tar.gz
- bookkeeper-server-4.11.1-bin.tar.gz
- apache-zookeeper-3.5.8-bin.tar.gz
</code></pre><p>In terms of hardware:</p><pre><code>- Zookeeper ensemble (3 nodes)
- BookKeeper cluster (3 bookies)
- Pulsar cluster (3 brokers)
</code></pre><h2 id=guide-summary>Guide Summary</h2><pre tabindex=0><code>- Deploying Binaries on Each Node
  - Creating directories
  - Changing directory ownership
  - Moving tar binary (scp)
  - Untar Binary
  - Remove tar binary
- Zookeeper Configuration
  - Cluster Info
  - Setting up Local Zookeeper for Pulsar
    - Cluster Info
    - Configuring Local Zookeeper
    - Setting up zoo.cfg file for Local Zookeeper
    - Start/Stop Local Zookeeper
    - Launch Client Zookeeper for Local Zookeeper
    - Creating Znode for Local Zookeeper Metadata
  - Setting up Global Zookeeper for Pulsar (store)
    - Cluster Info
    - Configuring Global Zookeeper
    - Setting up zoo_pulsar_global.cfg file for Global Zookeeper
      - Instructions to add new Pulsar cluster Zookeeper Configuration
    - Start/Stop Global Zookeeper
    - Launch Client Zookeeper for Global Zookeeper
    - Creating Znode for Global Zookeeper Metadata
- Bookkeeper Configuration
  - Cluster Info
  - Creating a Znode for BookKeeper metadata in Zookeeper Local
  - Setting up bk_server.conf file for BookKeeper
  - Sending BookKeeper metadata to Zookeeper Local
  - Start BookKeeper
- Pulsar Configuration
  - Cluster Info
  - Setting up bk_server.conf file for Pulsar (brokers)
    - Enabling Functions within Brokers
  - Sending Pulsar metadata to Zookeeper (Local and Global) and Registering BookKeeper
  - Start Pulsar Broker
  - Confirming Brokers available
- Conclusion
</code></pre><h2 id=1-deploying-binaries-on-each-node>1) Deploying Binaries On Each Node</h2><p>Do the following if you can ssh to your remote machines. Install the binaries accordingly within your ensemble/clusters, <strong>3 times for Zookeeper, 3 times for BookKeeper and 3 times for Pulsar</strong>.</p><h3 id=creating-directories>Creating directories</h3><pre tabindex=0><code>igdr@&lt;ip-hostname&gt;:/opt$ sudo mkdir &lt;directory_name&gt;
</code></pre><p>do this for each of your nodes, where your &lt;ip-hostname> is your hostname and &lt;directory_name> is either zookeeper, bookkeeper, pulsar</p><h3 id=changing-directory-ownership>Changing directory ownership</h3><pre tabindex=0><code>igdr@&lt;ip-hostname&gt;:/opt$ sudo chown -R igdr:igdr &lt;directory_name&gt;
</code></pre><h3 id=copying-tar-binary-to-destination-nodes-scp>Copying tar binary to destination nodes (scp)</h3><p>Instead downloading the binaries individually on each remote machine, using e.g. &ldquo;wget&rdquo; command, I downloaded once the bin.tar.gz files on my local machine and sent the files using scp command to the remote machines.</p><pre tabindex=0><code>/Downloads/Project_Pulsar: scp -i /path_to/ssh_key \
file-name.bin.tar.gz igdr@&lt;ip-hostname&gt;:/opt/&lt;directory_name&gt;/
</code></pre><p>Here &lt;directory_name> is the directory created initially.</p><h3 id=untar-binary>Untar binary</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-4-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-4-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#a6e22e>hostname</span><span style=color:#f92672>&gt;:</span><span style=color:#e6db74>/opt/</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>directory_name</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>$</span> <span style=color:#a6e22e>tar</span> <span style=color:#a6e22e>xvzf</span> <span style=color:#a6e22e>file</span><span style=color:#f92672>-</span><span style=color:#a6e22e>name</span>.<span style=color:#a6e22e>bin</span>.<span style=color:#a6e22e>tar</span>.<span style=color:#a6e22e>gz</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=remove-tar-binary>Remove tar binary</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-5-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-5-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#a6e22e>hostname</span><span style=color:#f92672>&gt;:</span><span style=color:#e6db74>/opt/</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>directory_name</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>$</span> <span style=color:#a6e22e>rm</span> <span style=color:#a6e22e>file</span><span style=color:#f92672>-</span><span style=color:#a6e22e>name</span>.<span style=color:#a6e22e>bin</span>.<span style=color:#a6e22e>tar</span>.<span style=color:#a6e22e>gz</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=2-zookeeper-configuration>2) Zookeeper Configuration</h2><h3 id=cluster-info-local-and-global>Cluster Info (Local and Global)</h3><pre tabindex=0><code>Nodes:
Node 0: public hostname: 101.36.207
Node 1: public hostname: 101.36.165
Node 2: public hostname: 101.36.179
</code></pre><h2 id=2a-setting-up-local-zookeeper-for-pulsar>2.A) Setting up Local Zookeeper for Pulsar</h2><h3 id=configuring-local-zookeeper>Configuring Local Zookeeper</h3><p><code>Creating myid file within datadir=/opt/zookeeper/data</code></p><pre tabindex=0><code>Notes for configuration of &#34;myid&#34; files within each Zookeeper node (Local)

Node 0: 101.36.207 -&gt; insert 1
Node 1: 101.36.165 -&gt; insert 2
Node 2: 101.36.179 -&gt; insert 3

echo &#34;1&#34; &gt; /opt/zookeeper/data/myid
echo &#34;2&#34; &gt; /opt/zookeeper/data/myid
echo &#34;3&#34; &gt; /opt/zookeeper/data/myid
</code></pre><h3 id=setting-up-zoocfg-files-for-local-zookeeper>Setting up zoo.cfg files for Local Zookeeper</h3><p>Main variables, according to pulsar documentation:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-13>13</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-14>14</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-15>15</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-16>16</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-17><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-17>17</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-18><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-18>18</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-19><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-19>19</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-8-20><a style=outline:none;text-decoration:none;color:inherit href=#hl-8-20>20</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>tickTime</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>initLimit</span><span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>syncLimit</span><span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>dataDir</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/data</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>clientPort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2181</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>admin</span>.<span style=color:#a6e22e>enableServer</span><span style=color:#f92672>=</span><span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>admin</span>.<span style=color:#a6e22e>serverPort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>9990</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>maxClientCnxns</span><span style=color:#f92672>=</span><span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>autopurge</span>.<span style=color:#a6e22e>snapRetainCount</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>autopurge</span>.<span style=color:#a6e22e>purgeInterval</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>forceSync</span><span style=color:#f92672>=</span><span style=color:#a6e22e>yes</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>sslQuorum</span><span style=color:#f92672>=</span><span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>portUnification</span><span style=color:#f92672>=</span><span style=color:#66d9ef>false</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>metricsProvider</span>.<span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>org</span>.<span style=color:#a6e22e>apache</span>.<span style=color:#a6e22e>zookeeper</span>.<span style=color:#a6e22e>metrics</span>.<span style=color:#a6e22e>prometheus</span>.<span style=color:#a6e22e>PrometheusMetricsProvider</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>metricsProvider</span>.<span style=color:#a6e22e>httpPort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>8000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>metricsProvider</span>.<span style=color:#a6e22e>exportJvmInfo</span><span style=color:#f92672>=</span><span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2888</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3888</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>2</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2888</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3888</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>3</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2888</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3888</span>
</span></span></code></pre></td></tr></table></div></div><p>Same file content for each of the Zookeeper nodes.</p><h3 id=startstop-local-zookeeper>Start/Stop Local Zookeeper</h3><p><strong>Start local Zookeeper</strong>
Do this for each node, this example corresponds to Zk server.1 only</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-9-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-9-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkServer</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>start</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>opt</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>/</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>-</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.5</span>.<span style=color:#ae81ff>8</span><span style=color:#f92672>-</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>conf</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zoo</span>.<span style=color:#a6e22e>cfg</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Stop local Zookeeper</strong>
Do this for each node, this example corresponds to Zk server.1 only</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-10-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-10-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkServer</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>stop</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>opt</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>/</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>-</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.5</span>.<span style=color:#ae81ff>8</span><span style=color:#f92672>-</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>conf</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zoo</span>.<span style=color:#a6e22e>cfg</span> 
</span></span></code></pre></td></tr></table></div></div><h3 id=launch-client-zookeper-for-local-zookeeper>Launch Client Zookeper for Local Zookeeper</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-11-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-11-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkCli</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>server</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=creating-znode-for-local-zookeeper-metadata>Creating Znode for Local Zookeeper Metadata</h3><p>Creating the Znode from one Zk client is enough</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-12-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-12-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>0</span>] <span style=color:#a6e22e>create</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkLocal</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Created</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkLocal</span>
</span></span></code></pre></td></tr></table></div></div><p>Verifying Znode has been created as expected:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-13-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-13-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>1</span>] <span style=color:#a6e22e>ls</span> <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>PulsarZkLocal</span>, <span style=color:#a6e22e>zookeeper</span>]
</span></span></code></pre></td></tr></table></div></div><h2 id=2b-setting-up-global-zookeeper-for-pulsar-store>2.B) Setting up Global Zookeeper for Pulsar (store)</h2><h3 id=configuring-global-zookeeper>Configuring Global Zookeeper</h3><p><code>Creating myid file within datadir=/opt/zookeeper/data_global</code></p><pre tabindex=0><code>Notes for configuration of &#34;myid&#34; files within each Zookeeper node (Global)

Node 0: 101.36.207 -&gt; insert 1
Node 1: 101.36.165 -&gt; insert 2
Node 2: 101.36.179 -&gt; insert 3

echo &#34;1&#34; &gt; /opt/zookeeper/data_global/myid
echo &#34;2&#34; &gt; /opt/zookeeper/data_global/myid
echo &#34;3&#34; &gt; /opt/zookeeper/data_global/myid
</code></pre><h3 id=setting-up-zoo_pulsar_globalcfg-file-for-global-zookeeper>Setting up zoo_pulsar_global.cfg file for Global Zookeeper</h3><p>Main variables, according to Pulsar documentation:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-15-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-15-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>tickTime</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>initLimit</span><span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>syncLimit</span><span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>dataDir</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/data_global</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>clientPort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2184</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>admin</span>.<span style=color:#a6e22e>enableServer</span><span style=color:#f92672>=</span><span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>admin</span>.<span style=color:#a6e22e>serverPort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>9991</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>maxClientCnxns</span><span style=color:#f92672>=</span><span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>autopurge</span>.<span style=color:#a6e22e>snapRetainCount</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>autopurge</span>.<span style=color:#a6e22e>purgeInterval</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>1</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2889</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3889</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>2</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2889</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3889</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server</span>.<span style=color:#ae81ff>3</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2889</span><span style=color:#f92672>:</span><span style=color:#ae81ff>3889</span>
</span></span></code></pre></td></tr></table></div></div><blockquote><p>Note 1: It is important to note that a separate zookeeper ensemble for a Global Pulsar Store will require the same numbers of local pulsar zookeeper ensemble machines per cluster, it will make it not cost effective, considering the workload for the global store is very reduced.</p></blockquote><blockquote><p>Note 2: If another cluster is added to the pulsar instance, within this file the new zk nodes IP‚Äôs will need to be added and additionally we may use the :observer option. E.g. adding 2 more clusters of 3 nodes ensemble each and making a 7 nodes ensemble using the observer option to avoid election we can tolerate up to 3 nodes down or an entire region to be down (2 x 3 Nodes Down+1=7). The modified file would look like this:</p></blockquote><pre tabindex=0><code>Instructions to add new Pulsar cluster Zookeeper Configuration (modified: zoo_pulsar_global.cfg file)

peerType=observer
server.1=101.36.207:2889:3889
server.2=101.36.165:2889:3889
server.3=101.36.179:2889:3889

server.4=zk-4IP-Region2:2889:3889
server.5=zk-5IP-Region2:2889:3889
server.6=zk-6IP-Region2:2889:3889:observer

server.7=zk-7IP-Region3:2889:3889
server.8=zk-8IP-Region3:2889:3889
server.9=zk-9IP-Region3:22889:3889:observer 
</code></pre><p>When adding two new clusters for example as shown above, the new configuration file will have to be the same on all ZK nodes. where myid files for the new two local ZK (2181) will contain 1,2,3 and 1,2,3 also for the global ZK (2184) will be 4,5,6 and 7,8,9 following the example above.</p><h3 id=startstop-global-zookeeper>Start/Stop Global Zookeeper</h3><p><strong>Start global Zookeeper</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-17-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-17-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkServer</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>start</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>opt</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>/</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>-</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.5</span>.<span style=color:#ae81ff>8</span><span style=color:#f92672>-</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>conf</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zoo_pulsar_global</span>.<span style=color:#a6e22e>cfg</span>
</span></span></code></pre></td></tr></table></div></div><p><strong>Stop global Zookeeper</strong></p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-18-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-18-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkServer</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>stop</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>opt</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>/</span><span style=color:#a6e22e>apache</span><span style=color:#f92672>-</span><span style=color:#a6e22e>zookeeper</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3.5</span>.<span style=color:#ae81ff>8</span><span style=color:#f92672>-</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>conf</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zoo_pulsar_global</span>.<span style=color:#a6e22e>cfg</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=launch-client-zookeper-for-global-zookeeper>Launch Client Zookeper for Global Zookeeper</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-19-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-19-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>36</span><span style=color:#f92672>-</span><span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/zookeeper/apache-zookeeper-3.5.8-bin$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>zkCli</span>.<span style=color:#a6e22e>sh</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>server</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=creating-znode-for-global-zookeeper-metadata>Creating Znode for Global Zookeeper Metadata</h3><p>Creating the Znode fron one Zk client is enough</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-20-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-20-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>1</span>] <span style=color:#a6e22e>create</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkGlobal</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Created</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkGlobal</span>
</span></span></code></pre></td></tr></table></div></div><p>Verifying Znode for Global Pulsar metadata has been created:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-21-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-21-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>2</span>] <span style=color:#a6e22e>ls</span> <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>PulsarZkGlobal</span>, <span style=color:#a6e22e>zookeeper</span>]
</span></span></code></pre></td></tr></table></div></div><h2 id=3-bookkeeper-configuration>3) Bookkeeper Configuration</h2><h3 id=cluster-info>Cluster Info</h3><pre tabindex=0><code>Nodes:
Node 0: public hostname: 101.33.97
Node 1: public hostname: 101.35.236
Node 2: public hostname: 101.32.196
</code></pre><h3 id=creating-a-znode-for-bookkeeper-metadata-in-zookeeper-local>Creating a Znode for BookKeeper metadata in Zookeeper Local</h3><p>After connecting with the ZK client to the local ZK ensemble:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-23-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-23-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>3</span>] <span style=color:#a6e22e>create</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkBk</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Created</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkBk</span>
</span></span></code></pre></td></tr></table></div></div><p>furthermore:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-24-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-24-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>4</span>] <span style=color:#a6e22e>create</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkBk</span><span style=color:#f92672>/</span><span style=color:#a6e22e>ledgers</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Created</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkBk</span><span style=color:#f92672>/</span><span style=color:#a6e22e>ledgers</span>
</span></span></code></pre></td></tr></table></div></div><p>Verifying Znode for BookKeeper metadata has been created:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-25-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-25-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>1</span>] <span style=color:#a6e22e>ls</span> <span style=color:#f92672>/</span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>PulsarZkLocal</span>, <span style=color:#a6e22e>PulsarZkBk</span>, <span style=color:#a6e22e>zookeeper</span>]
</span></span></code></pre></td></tr></table></div></div><h3 id=setting-up-bk_serverconf-file-for-bookkeeper>Setting up bk_server.conf file for BookKeeper</h3><p>Main variables, according to Pulsar documentation:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-6>6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-7>7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-8>8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-26-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-26-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>bookiePort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>3181</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>advertisedAddress</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.33</span>.<span style=color:#ae81ff>97</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>journalDirectories</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>/opt/bookkeeper/data/bk-journals</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ledgerStorageClass</span><span style=color:#f92672>=</span><span style=color:#a6e22e>org</span>.<span style=color:#a6e22e>apache</span>.<span style=color:#a6e22e>bookkeeper</span>.<span style=color:#a6e22e>bookie</span>.<span style=color:#a6e22e>storage</span>.<span style=color:#a6e22e>ldb</span>.<span style=color:#a6e22e>DbLedgerStorage</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ledgerDirectories</span><span style=color:#f92672>=</span><span style=color:#960050;background-color:#1e0010>/opt/bookkeeper/data/bk-ledgers</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>metadataServiceUri</span><span style=color:#f92672>=</span><span style=color:#a6e22e>zk</span><span style=color:#f92672>+</span><span style=color:#a6e22e>hierarchical</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.36.207:2181;101.36.165:2181;101.36.179/PulsarZkBk/ledgers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#e6db74>`zkServers`</span> <span style=color:#a6e22e>is</span> <span style=color:#a6e22e>deprecated</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>favor</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>using</span> <span style=color:#e6db74>`metadataServiceUri`</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span><span style=color:#a6e22e>zkServers</span><span style=color:#f92672>=</span><span style=color:#a6e22e>localhost</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>
</span></span></code></pre></td></tr></table></div></div><p>Important</p><p><strong>Note 1:</strong> metadataServiceUri points to Local ZK IP‚Äôs.</p><p><strong>Note 2:</strong> in metadataServiceUri use ‚Äú;‚Äù instead of ‚Äú,‚Äù for IP:PORT separation.</p><h3 id=sending-bookkeper-metadata-to-zookeeper-local>Sending BookKeper metadata to Zookeeper Local</h3><p>Just from one BookKeeper node</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-27-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-27-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>igdr@ip-101-33-97:/opt/bookkeeper/bookkeeper-server-4.11.1$
</span></span><span style=display:flex><span>./bin/bookkeeper shell metaformat
</span></span></code></pre></td></tr></table></div></div><p>The output confirming this:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-6>6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-7>7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-8>8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-28-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-28-9>9</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>INFO  BookKeeper metadata driver manager initialized
</span></span><span style=display:flex><span>INFO  Initialize zookeeper metadata driver at metadata service uri
</span></span><span style=display:flex><span>zk+hierarchical:
</span></span><span style=display:flex><span>//101.36.207:2181;101.36.165:2181;101.36.179/PulsarZkBk/ledgers : 
</span></span><span style=display:flex><span>zkServers <span style=color:#f92672>=</span> 101.36.207:2181,101.36.165:2181,101.36.179,
</span></span><span style=display:flex><span>ledgersRootPath <span style=color:#f92672>=</span> /PulsarZkBk/ledgers.
</span></span><span style=display:flex><span>Ledger root already exists. Are you sure to format bookkeeper metadata?
</span></span><span style=display:flex><span>This may cause data loss. <span style=color:#f92672>(</span>Y or N<span style=color:#f92672>)</span> Y
</span></span><span style=display:flex><span>INFO  Successfully formatted BookKeeper metadata
</span></span></code></pre></td></tr></table></div></div><p>Additionally check BookKeeper Znode in one of the ‚Äúlocal‚Äù Zookeeper servers</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-29-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-29-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span>[<span style=color:#a6e22e>zk</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>(<span style=color:#a6e22e>CONNECTED</span>) <span style=color:#ae81ff>8</span>] <span style=color:#a6e22e>ls</span> <span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkBk</span><span style=color:#f92672>/</span><span style=color:#a6e22e>ledgers</span>
</span></span><span style=display:flex><span>[<span style=color:#a6e22e>INSTANCEID</span>, <span style=color:#a6e22e>LAYOUT</span>, <span style=color:#a6e22e>available</span>]
</span></span></code></pre></td></tr></table></div></div><h3 id=start-bookkeeper>Start BookKeeper</h3><p>Do this for each node/hostname</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-30-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-30-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>33</span><span style=color:#f92672>-</span><span style=color:#ae81ff>97</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/bookkeeper/bookkeeper-server-4.11.1$</span>
</span></span><span style=display:flex><span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>bin</span><span style=color:#f92672>/</span><span style=color:#a6e22e>bookkeeper</span> <span style=color:#a6e22e>bookie</span>
</span></span></code></pre></td></tr></table></div></div><p>Output received:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-6>6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-31-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-31-7>7</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>INFO  - <span style=color:#f92672>[</span>main:Main@274<span style=color:#f92672>]</span> - Hello, I<span style=color:#960050;background-color:#1e0010>&#39;</span>m your bookie, listening on port 3181.
</span></span><span style=display:flex><span>Metadata service uri is zk+hierarchical:
</span></span><span style=display:flex><span>//101.36.207:2181;101.36.165:2181;101.36.179/PulsarZkBk/ledgers.
</span></span><span style=display:flex><span>Journals are in <span style=color:#f92672>[</span>/opt/bookkeeper/data/bk-journals<span style=color:#f92672>]</span>.
</span></span><span style=display:flex><span>Ledgers are stored in /opt/bookkeeper/data/bk-ledgers.
</span></span><span style=display:flex><span>INFO  - <span style=color:#f92672>[</span>main:Bookie@991<span style=color:#f92672>]</span> - Finished reading journal, starting bookie
</span></span><span style=display:flex><span>INFO  - <span style=color:#f92672>[</span>main:ComponentStarter@86<span style=color:#f92672>]</span> - Started component bookie-server.
</span></span></code></pre></td></tr></table></div></div><h2 id=4-pulsar-configuration>4) Pulsar Configuration</h2><h3 id=cluster-info-1>Cluster Info</h3><pre tabindex=0><code>Nodes:
Node 0: public hostname: 101.32.178
Node 1: public hostname: 101.34.49
Node 2: public hostname: 101.34.42
</code></pre><h3 id=setting-up-brokerconf-file-for-pulsar-brokers>Setting up broker.conf file for Pulsar (brokers)</h3><p>Main variables, according to Pulsar documentation:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-33-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-33-13>13</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>zookeeperServers</span><span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span><span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkLocal</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>configurationStoreServers</span><span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span><span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkGlobal</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>brokerServicePort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>6650</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>brokerServicePortTls</span><span style=color:#f92672>=</span><span style=color:#ae81ff>6651</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>webServicePort</span><span style=color:#f92672>=</span><span style=color:#ae81ff>8080</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>webServicePortTls</span><span style=color:#f92672>=</span><span style=color:#ae81ff>8443</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>bindAddress</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0.0</span>.<span style=color:#ae81ff>0.0</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>advertisedAddress</span><span style=color:#f92672>=</span><span style=color:#ae81ff>101.32</span>.<span style=color:#ae81ff>178</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>clusterName</span><span style=color:#f92672>=</span><span style=color:#a6e22e>Chinchaysuyo</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>bookkeeperMetadataServiceUri</span><span style=color:#f92672>=</span><span style=color:#a6e22e>zk</span><span style=color:#f92672>+</span><span style=color:#a6e22e>hierarchical</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.36.207:2181;101.36.165:2181;101.36.179:2181/PulsarZkBk/ledgers
</span></span></span></code></pre></td></tr></table></div></div><h3 id=enabling-functions-within-brokers>Enabling Functions within Brokers</h3><p>Additionally to enable function worker in brokers, also in bk_server.conf file:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-34-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-34-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>###</span> <span style=color:#f92672>---</span> <span style=color:#a6e22e>Functions</span> <span style=color:#f92672>---</span> <span style=color:#960050;background-color:#1e0010>###</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> <span style=color:#a6e22e>Enable</span> <span style=color:#a6e22e>Functions</span> <span style=color:#a6e22e>Worker</span> <span style=color:#a6e22e>Service</span> <span style=color:#66d9ef>in</span> <span style=color:#a6e22e>Broker</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>functionsWorkerEnabled</span><span style=color:#f92672>=</span><span style=color:#66d9ef>true</span>
</span></span></code></pre></td></tr></table></div></div><p>In functions_worker.yml file</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-35-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-35-4>4</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>################################</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>#</span> Function <span style=color:#66d9ef>package</span> <span style=color:#a6e22e>management</span>
</span></span><span style=display:flex><span><span style=color:#960050;background-color:#1e0010>################################</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>numFunctionPackageReplicas</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>2</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=sending-pulsar-metadata-to-zookeeper-local-and-global-and-registering-bookkeeper>Sending Pulsar metadata to Zookeeper (Local and Global) and Registering BookKeeper</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-1> 1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-2> 2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-3> 3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-4> 4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-5> 5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-6> 6</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-7><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-7> 7</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-8><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-8> 8</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-9><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-9> 9</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-10><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-10>10</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-11><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-11>11</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-12><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-12>12</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-13><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-13>13</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-14><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-14>14</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-15><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-15>15</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-36-16><a style=outline:none;text-decoration:none;color:inherit href=#hl-36-16>16</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>32</span><span style=color:#f92672>-</span><span style=color:#ae81ff>178</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/pulsar/apache-pulsar-2.8.1$ ./bin/pulsar \</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>initialize</span><span style=color:#f92672>-</span><span style=color:#a6e22e>cluster</span><span style=color:#f92672>-</span><span style=color:#a6e22e>metadata</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#a6e22e>cluster</span> <span style=color:#a6e22e>Chinchaysuyo</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#a6e22e>zookeeper</span> <span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2181</span><span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkLocal</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#a6e22e>configuration</span><span style=color:#f92672>-</span><span style=color:#a6e22e>store</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>207</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>165</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span>,<span style=color:#ae81ff>101.36</span>.<span style=color:#ae81ff>179</span><span style=color:#f92672>:</span><span style=color:#ae81ff>2184</span><span style=color:#f92672>/</span><span style=color:#a6e22e>PulsarZkGlobal</span> <span style=color:#960050;background-color:#1e0010>\</span> 
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#a6e22e>existing</span><span style=color:#f92672>-</span><span style=color:#a6e22e>bk</span><span style=color:#f92672>-</span><span style=color:#a6e22e>metadata</span><span style=color:#f92672>-</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-</span><span style=color:#a6e22e>uri</span> <span style=color:#e6db74>&#34;zk+hierarchical:
</span></span></span><span style=display:flex><span><span style=color:#e6db74>//101.36.207:2181;101.36.165:2181;101.36.179:2181/PulsarZkBk/ledgers&#34;</span> <span style=color:#f92672>\</span>
</span></span><span style=display:flex><span><span style=color:#f92672>--</span><span style=color:#a6e22e>web</span><span style=color:#f92672>-</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-</span><span style=color:#a6e22e>url</span> <span style=color:#a6e22e>http</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.32.178:8080,101.34.49:8080,101.34.42:8080 \
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>--</span><span style=color:#a6e22e>web</span><span style=color:#f92672>-</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-</span><span style=color:#a6e22e>url</span><span style=color:#f92672>-</span><span style=color:#a6e22e>tls</span> <span style=color:#a6e22e>https</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.32.178:8443,101.34.49:8443,101.34.42:8443 \
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>--</span><span style=color:#a6e22e>broker</span><span style=color:#f92672>-</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-</span><span style=color:#a6e22e>url</span> <span style=color:#a6e22e>pulsar</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.32.178:6650,101.34.49:6650,101.34.42:6650 \
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#f92672>--</span><span style=color:#a6e22e>broker</span><span style=color:#f92672>-</span><span style=color:#a6e22e>service</span><span style=color:#f92672>-</span><span style=color:#a6e22e>url</span><span style=color:#f92672>-</span><span style=color:#a6e22e>tls</span> <span style=color:#a6e22e>pulsar</span><span style=color:#f92672>+</span><span style=color:#a6e22e>ssl</span><span style=color:#f92672>:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>//101.32.178:6651,101.34.49:6651,101.34.42:6651
</span></span></span></code></pre></td></tr></table></div></div><p>The output after execution:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-3>3</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-4><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-4>4</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-5><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-5>5</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-37-6><a style=outline:none;text-decoration:none;color:inherit href=#hl-37-6>6</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span>INFO  Setting up cluster Chinchaysuyo with zk
</span></span><span style=display:flex><span><span style=color:#f92672>=</span>101.36.207:2181,101.36.165:2181,101.36.179:2181/PulsarZkLocal
</span></span><span style=display:flex><span>configuration-store<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>101.36.207:2184,101.36.165:2184,101.36.179:2184/PulsarZkGlobal
</span></span><span style=display:flex><span>INFO  EventThread shut down <span style=color:#66d9ef>for</span> session: 0x10016a8eb830004
</span></span><span style=display:flex><span>INFO  Pulsar Cluster metadata <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;Chinchaysuyo&#39;</span> setup correctly
</span></span></code></pre></td></tr></table></div></div><h3 id=start-pulsar-broker>Start Pulsar Broker</h3><p>Do this for all the Pulsar nodes/brokers</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-38-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-38-1>1</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>32</span><span style=color:#f92672>-</span><span style=color:#ae81ff>178</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/pulsar/apache-pulsar-2.8.1$ ./bin/pulsar broker</span>
</span></span></code></pre></td></tr></table></div></div><p>Output after execution:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-39-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-39-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>INFO</span>  <span style=color:#a6e22e>org</span>.<span style=color:#a6e22e>apache</span>.<span style=color:#a6e22e>pulsar</span>.<span style=color:#a6e22e>broker</span>.<span style=color:#a6e22e>PulsarService</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>Starting</span> <span style=color:#a6e22e>Pulsar</span> <span style=color:#a6e22e>Broker</span> <span style=color:#a6e22e>service</span>;
</span></span><span style=display:flex><span><span style=color:#a6e22e>version</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;2.8.1&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>INFO</span>  <span style=color:#a6e22e>org</span>.<span style=color:#a6e22e>apache</span>.<span style=color:#a6e22e>pulsar</span>.<span style=color:#a6e22e>PulsarBrokerStarter</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>PulsarService</span> <span style=color:#a6e22e>started</span>.
</span></span></code></pre></td></tr></table></div></div><h3 id=confirming-brokers-available>Confirming Brokers available:</h3><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-40-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-40-2>2</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-js data-lang=js><span style=display:flex><span><span style=color:#a6e22e>igdr</span><span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>ip</span><span style=color:#f92672>-</span><span style=color:#ae81ff>101</span><span style=color:#f92672>-</span><span style=color:#ae81ff>32</span><span style=color:#f92672>-</span><span style=color:#ae81ff>178</span><span style=color:#f92672>:</span><span style=color:#960050;background-color:#1e0010>/opt/pulsar/apache-pulsar-2.8.1$ ./bin/pulsar-admin \</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>brokers</span> <span style=color:#a6e22e>list</span> <span style=color:#a6e22e>Chinchaysuyo</span>
</span></span></code></pre></td></tr></table></div></div><p>Output after execution:</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-1><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-1>1</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-2><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-2>2</a>
</span><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f" id=hl-41-3><a style=outline:none;text-decoration:none;color:inherit href=#hl-41-3>3</a>
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#34;101.32.178:8080&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;101.34.49:8080&#34;</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34;101.34.42:8080&#34;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=conclusion>Conclusion</h2><p>Implementing a high available Pulsar instance is relatively easy. All the configurations shown in this guide need to be done as many times as nodes are available in the Pulsar instance, except the metadata sent from BookKeeper to Zookeeper and from Pulsar to Zookeeper which is only done from one node. The Pulsar Cluster then should be ready to publish and consume messages and additionally use I/O functions.
In the next and last blog of this series, I will analyse the logs generated when each of these components are initialised.</p></article><br><div id=disqus_thread></div><script type=text/javascript>(function(){if(window.location.hostname=="localhost")return;var t,e=document.createElement("script");e.type="text/javascript",e.async=!0,t="pulsar-neighborhood",e.src="//"+t+".disqus.com/embed.js",(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(e)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></div></div><div class="col-0 col-md-2"><nav class="navbar navbar-light mb-3"><div class=row><div class=col-12><h4>In this article</h4></div><div class="col-12 border-left border-primary pr-0"><nav id=TableOfContents><ul><li><ul><li><a href=#a-step-by-step-cookbook>A step by step cookbook</a></li></ul></li><li><a href=#context>Context</a></li><li><a href=#resources>Resources</a></li><li><a href=#guide-summary>Guide Summary</a></li><li><a href=#1-deploying-binaries-on-each-node>1) Deploying Binaries On Each Node</a><ul><li><a href=#creating-directories>Creating directories</a></li><li><a href=#changing-directory-ownership>Changing directory ownership</a></li><li><a href=#copying-tar-binary-to-destination-nodes-scp>Copying tar binary to destination nodes (scp)</a></li><li><a href=#untar-binary>Untar binary</a></li><li><a href=#remove-tar-binary>Remove tar binary</a></li></ul></li><li><a href=#2-zookeeper-configuration>2) Zookeeper Configuration</a><ul><li><a href=#cluster-info-local-and-global>Cluster Info (Local and Global)</a></li></ul></li><li><a href=#2a-setting-up-local-zookeeper-for-pulsar>2.A) Setting up Local Zookeeper for Pulsar</a><ul><li><a href=#configuring-local-zookeeper>Configuring Local Zookeeper</a></li><li><a href=#setting-up-zoocfg-files-for-local-zookeeper>Setting up zoo.cfg files for Local Zookeeper</a></li><li><a href=#startstop-local-zookeeper>Start/Stop Local Zookeeper</a></li><li><a href=#launch-client-zookeper-for-local-zookeeper>Launch Client Zookeper for Local Zookeeper</a></li><li><a href=#creating-znode-for-local-zookeeper-metadata>Creating Znode for Local Zookeeper Metadata</a></li></ul></li><li><a href=#2b-setting-up-global-zookeeper-for-pulsar-store>2.B) Setting up Global Zookeeper for Pulsar (store)</a><ul><li><a href=#configuring-global-zookeeper>Configuring Global Zookeeper</a></li><li><a href=#setting-up-zoo_pulsar_globalcfg-file-for-global-zookeeper>Setting up zoo_pulsar_global.cfg file for Global Zookeeper</a></li><li><a href=#startstop-global-zookeeper>Start/Stop Global Zookeeper</a></li><li><a href=#launch-client-zookeper-for-global-zookeeper>Launch Client Zookeper for Global Zookeeper</a></li><li><a href=#creating-znode-for-global-zookeeper-metadata>Creating Znode for Global Zookeeper Metadata</a></li></ul></li><li><a href=#3-bookkeeper-configuration>3) Bookkeeper Configuration</a><ul><li><a href=#cluster-info>Cluster Info</a></li><li><a href=#creating-a-znode-for-bookkeeper-metadata-in-zookeeper-local>Creating a Znode for BookKeeper metadata in Zookeeper Local</a></li><li><a href=#setting-up-bk_serverconf-file-for-bookkeeper>Setting up bk_server.conf file for BookKeeper</a></li><li><a href=#sending-bookkeper-metadata-to-zookeeper-local>Sending BookKeper metadata to Zookeeper Local</a></li><li><a href=#start-bookkeeper>Start BookKeeper</a></li></ul></li><li><a href=#4-pulsar-configuration>4) Pulsar Configuration</a><ul><li><a href=#cluster-info-1>Cluster Info</a></li><li><a href=#setting-up-brokerconf-file-for-pulsar-brokers>Setting up broker.conf file for Pulsar (brokers)</a></li><li><a href=#enabling-functions-within-brokers>Enabling Functions within Brokers</a></li><li><a href=#sending-pulsar-metadata-to-zookeeper-local-and-global-and-registering-bookkeeper>Sending Pulsar metadata to Zookeeper (Local and Global) and Registering BookKeeper</a></li><li><a href=#start-pulsar-broker>Start Pulsar Broker</a></li><li><a href=#confirming-brokers-available>Confirming Brokers available:</a></li></ul></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></div></nav><div class="row border border-primary rounded no-gutters"><div class="col-12 bg-primary p-1"><div class=text-secondary>&nbsp;Join Our Newsletter</div></div><div class=col-12><div class=ctct-inline-form data-form-id=7514f5a0-b12d-44b3-93bf-e16449e783ca style=padding:0></div></div></div></div></div></div></div><div class="sub-footer m-5"><div class=row><div class="col-12 text-center"><a href=https://github.com/pulsar-neighborhood/pulsar-neighborhood.github.io/blob/main/content/articles/Building-a-High-Available-Messaging-System-A-Step-by-Step-CookBook.md target=_blank>Improve this page</a></div></div><div class="col-8 offset-2"><hr class="bg-primary text-primary"></div><div class="sub-footer-inner mt-2"><div><div class=mb-1>Pulsar Neighborhood</div><div><ul><li style=width:40px><a href=https://github.com/pulsar-neighborhood target=_blank><img src=/svg/github-brands.svg title="Pulsar Neighborhood on GitHub" class=img-fluid></a></li><li class="ml-3 mr-1" style=width:40px><a href=https://twitter.com/pulsar_neighbor target=_blank><img src=/svg/twitter-brands.svg title="Pulsar Neighborhood on Twitter" class=img-fluid></a></li><li style=width:40px><a href=https://www.youtube.com/c/ApachePulsarNeighborhood target=_blank><img src=/svg/youtube-brands.svg title="Pulsar Neighborhood on YouTube" class=img-fluid></a></li><li style=width:40px><a href=https://datastudio.google.com/reporting/743d9f31-c80f-4e60-b520-730631d3c250 target=_blank><img src=/png/google-analytics.png title="Pulsar Neighborhood analytics" class=img-fluid></a></li></ul></div></div><div class=p-5></div><div><div class=mb-1>Apache Pulsar</div><div><ul><li style=width:40px><a href=https://pulsar.apache.org target=_blank><img src=/png/pulsar-icon.jpg title="Apache Pulsar project home" class=img-fluid></a></li><li class="ml-3 mr-1" style=width:40px><a href=https://github.com/apache-pulsar target=_blank><img src=/svg/github-brands.svg title="Apache Pulsar on GitHub" class=img-fluid></a></li><li class=mr-1 style=width:40px><a href=https://twitter.com/Apache_Pulsar target=_blank><img src=/svg/twitter-brands.svg title="Apache Pulsar on Twitter" class=img-fluid></a></li><li class=mr-1 style=width:30px><a href=https://stackoverflow.com/questions/tagged/apache-pulsar target=_blank><img src=/svg/stack-overflow-brands.svg title="Apache Pulsar on Stackoverflow" class=img-fluid></a></li><li style=width:40px><a href=https://apache-pulsar.slack.com target=_blank><img src=/svg/slack-brands.svg title="Apache Pulsar slack channel" class=img-fluid></a></li></ul></div></div></div><div class="row text-center mb-3"><div class=col-12><a class="btn btn-info" href=https://pulsar.apache.org/community/ target=_blank>Join the Pulsar community</a></div></div><div class="row text-center"><div class="col-12 text-center"><div>Privacy Policy&nbsp;&nbsp;|&nbsp;&nbsp;Terms & Condition</div></div></div></div><script type=text/javascript src=/js/scripts.min.8efe3e711319c2d0a300a084134e3f3bedcb60dce21f1e0ef12767f654242b44.js></script>
<script type=text/javascript src=/js/filter.min.2ee09abe7fb6b636d1e7cc4506185cec9d630337089eff4daf0ccc27318f376e.js></script>
<script src=https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js integrity=sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF crossorigin=anonymous></script>
<script>var _ctct_m="310a7590faa964361197c4644ef1de96"</script><script id=signupScript src=//static.ctctcdn.com/js/signup-form-widget/current/signup-form-widget.min.js async defer></script><div class="modal fade" id=sticker-signup tabindex=-1 role=dialog aria-labelledby=sticker-signup aria-hidden=true><div class="modal-dialog modal-dialog-centered modal-lg" role=document><div class=modal-content><iframe src="https://docs.google.com/forms/d/e/1FAIpQLSeUE7DY5caXwkOj2Rsn30hsJVCn8zdWhDBQwlPYvP9lrztqwQ/viewform?embedded=true" width=100% height=700 frameborder=0 marginheight=0 marginwidth=0>Loading‚Ä¶</iframe></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-8S9SD43SBH"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-8S9SD43SBH")</script></body></html>